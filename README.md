# Gemini document understanding

This script summarizes the content of a PDF document using the Gemini API.

# Requirements
- python 3.14

[//]: # (python 3.10 also works but I don't like it)

Install dependencies:
```
pip3 install -r requirements.txt
```

Put your API key in a `.env` file in the same directory as the script:

```
GEMINI_API_KEY="your_api_key_here"
```

# Usage

Optionally download a sample PDF
```
bash get_pdf.sh
```

Summarize a PDF document by providing the file path as an argument:
```
python3 doc_summary.py report.pdf
```
# Excel to Sankey Diagram Generator (Excel è½‰ Sankey åœ–è¡¨ç”¢ç”Ÿå™¨)

é€™æ˜¯ä¸€å€‹ Python è…³æœ¬ï¼Œç”¨æ–¼è®€å–ç‰¹å®šæ ¼å¼çš„ Excel æª”æ¡ˆï¼Œä¸¦è‡ªå‹•ç”¢ç”Ÿä¸€å€‹äº’å‹•å¼çš„ Sankey (æ¡‘åŸºåœ–) è¦–è¦ºåŒ–åœ–è¡¨ (HTML æª”æ¡ˆ)ã€‚

æœ¬è…³æœ¬ä½¿ç”¨ `pandas` è®€å– Excel è³‡æ–™ï¼Œä¸¦ä½¿ç”¨ `pyecharts` ç”¢ç”Ÿåœ–è¡¨ã€‚

## ğŸ¨ ç¯„ä¾‹è¼¸å‡º

![alt text](images/sankey_example.png)

## ğŸ› ï¸ å®‰è£èˆ‡è¨­å®š

åœ¨åŸ·è¡Œæ­¤è…³æœ¬ä¹‹å‰ï¼Œæ‚¨éœ€è¦è¨­å®šå¥½ Python ç’°å¢ƒä¸¦å®‰è£å¿…è¦çš„ç›¸ä¾å¥—ä»¶ã€‚

1.  **å»ºç«‹ä¸¦å•Ÿå‹•è™›æ“¬ç’°å¢ƒ** 

      * **macOS / Linux:**
        ```bash
        # å»ºç«‹
        python3 -m venv .venv
        # å•Ÿå‹•
        source .venv/bin/activate
        ```

2.  **å®‰è£ç›¸ä¾å¥—ä»¶**

    (è«‹ç¢ºä¿æ‚¨çš„è™›æ“¬ç’°å¢ƒå·²å•Ÿå‹•)
    ä½¿ç”¨ `requirements.txt` æª”æ¡ˆä¾†å®‰è£æ‰€æœ‰å¿…è¦çš„å¥—ä»¶ï¼š

    ```bash
    pip install -r requirements.txt
    ```

## ğŸ“Š å¿…è¦çš„ Excel è³‡æ–™æ ¼å¼

æ­¤è…³æœ¬**åš´æ ¼è¦æ±‚**æ‚¨çš„ Excel æª”æ¡ˆ (`.xlsx`) å¿…é ˆç¬¦åˆä»¥ä¸‹æ¬„ä½çµæ§‹ã€‚å®ƒæœƒè®€å– Excel ä¸­çš„ç¬¬ä¸€å€‹å·¥ä½œè¡¨ (worksheet)ã€‚

  * **A æ¬„ (ç´¢å¼• 0): `ä¾†æº (Source)`**
      * è³‡æ–™æµçš„èµ·å§‹ç¯€é»åç¨± (ä¾‹å¦‚: "ææ¬¾æ”¶å…¥")ã€‚
  * **B æ¬„ (ç´¢å¼• 1): `ç›®æ¨™ (Target)`**
      * è³‡æ–™æµçš„çµ‚é»ç¯€é»åç¨± (ä¾‹å¦‚: "æ”¶å…¥")ã€‚
  * **E æ¬„ (ç´¢å¼• 4): `æ•¸å€¼ (Value)`**
      * è©²ç­†è³‡æ–™æµçš„é‡‘é¡ (ä¾‹å¦‚: `9697.7`)ã€‚

**ç¯„ä¾‹å¦‚ä¸‹ (`data/A0226_112.xlsx`):**

| A æ¬„ (ä¾†æº) | B æ¬„ (ç›®æ¨™) | C æ¬„ | D æ¬„ | E æ¬„ (é‡‘é¡...) | F æ¬„ | ... |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| ææ¬¾æ”¶å…¥ | æ”¶å…¥ | ... | ... | 9697.7 | 1 | ... |
| è£œåŠ©æ”¶å…¥ | æ”¶å…¥ | ... | ... | 621.9 | 1 | ... |
| æ”¶å…¥ | æ¥­å‹™è²» | ... | ... | 7610.1 | 2 | ... |
| æ”¶å…¥ | äººäº‹è²» | ... | ... | 2157.0 | 2 | ... |
| æ¥­å‹™è²» | åŸ¹è‚²-èªæå°ˆæ¡ˆ | ... | ... | 6516.0 | 3 | ... |

*(è…³æœ¬æœƒè‡ªå‹•å¿½ç•¥ A, B, E æ¬„ä»¥å¤–çš„æ¬„ä½)*

## ğŸš€ å¦‚ä½•ä½¿ç”¨

æ‚¨éœ€è¦é€éçµ‚ç«¯æ©Ÿ (Terminal) ä¾†åŸ·è¡Œæ­¤è…³æœ¬ï¼Œä¸¦å°‡ Excel æª”æ¡ˆçš„è·¯å¾‘ä½œç‚ºåƒæ•¸å‚³å…¥ã€‚

(å‡è¨­æ‚¨çš„è…³æœ¬åç¨±ç‚º `generate_sankey.py`)

1.  å•Ÿå‹•æ‚¨çš„è™›æ“¬ç’°å¢ƒ (å¦‚æœå°šæœªå•Ÿå‹•)ï¼š

    ```bash
    source .venv/bin/activate
    ```

2.  åŸ·è¡Œè…³æœ¬ï¼Œå‚³å…¥æª”æ¡ˆè·¯å¾‘ï¼Œå…¶ä¸­ `-np` åƒæ•¸æ˜¯å¯é¸çš„ï¼š

    ```bash
    python create_sankey.py [æ‚¨çš„ Excel æª”æ¡ˆè·¯å¾‘] -np [æ‚¨è¦çš„ç™¾åˆ†æ¯”]
    ```

**å…·é«”ç¯„ä¾‹ï¼š**

```bash
python create_sankey.py data/A0226_112.xlsx -np 1.0
```

## ğŸ“‚ è¼¸å‡ºçµæœ

è…³æœ¬åŸ·è¡ŒæˆåŠŸå¾Œï¼š

1.  å®ƒæœƒè‡ªå‹•åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„å»ºç«‹ä¸€å€‹ `result/` è³‡æ–™å¤¾ (å¦‚æœå®ƒä¸å­˜åœ¨çš„è©±)ã€‚
2.  ä¸€å€‹æ–°çš„ `.html` æª”æ¡ˆå°‡è¢«å„²å­˜åœ¨ `result/` è³‡æ–™å¤¾ä¸­ã€‚
3.  è¼¸å‡ºçš„ HTML æª”åæœƒæ ¹æ“šæ‚¨çš„è¼¸å…¥æª”åè‡ªå‹•ç”¢ç”Ÿ (ä¾‹å¦‚: `A0226_112_sankey_np5.0.html`)ã€‚

æ‚¨å¯ä»¥ç›´æ¥åœ¨ä»»ä½•ç¶²é ç€è¦½å™¨ä¸­æ‰“é–‹é€™å€‹ HTML æª”æ¡ˆï¼Œä»¥æŸ¥çœ‹æ‚¨çš„äº’å‹•å¼ Sankey åœ–è¡¨ã€‚

```
Pyecharts Sankey åœ–è¡¨å·²æˆåŠŸç”Ÿæˆï¼
æª”æ¡ˆå·²å„²å­˜ç‚º: /.../workspace/result/A0226_112_sankey_np5.0.html
```